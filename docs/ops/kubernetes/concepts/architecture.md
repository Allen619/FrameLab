---
title: æ¶æ„æ¦‚è§ˆ | Kubernetes æ•™ç¨‹
description: ç†è§£ Kubernetes çš„æ•´ä½“æ¶æ„ï¼Œæ§åˆ¶å¹³é¢å’Œå·¥ä½œèŠ‚ç‚¹çš„ç»„æˆä¸èŒè´£
---

# æ¶æ„æ¦‚è§ˆ

æœ¬èŠ‚å¸®åŠ©ä½ ç†è§£ Kubernetes é›†ç¾¤çš„æ•´ä½“æ¶æ„ï¼Œäº†è§£å„ä¸ªç»„ä»¶å¦‚ä½•åä½œã€‚

## å‰ç½®çŸ¥è¯†

> ğŸ’¡ é˜…è¯»æœ¬ç« å‰ï¼Œè¯·ç¡®ä¿å·²å®Œæˆï¼š
> - [K8s æ˜¯ä»€ä¹ˆ](/ops/kubernetes/concepts/what-is-k8s) - ç†è§£ K8s çš„ä½œç”¨

## K8s é›†ç¾¤æ¶æ„

ä¸€ä¸ª Kubernetes é›†ç¾¤ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š

1. **æ§åˆ¶å¹³é¢ï¼ˆControl Planeï¼‰**ï¼šé›†ç¾¤çš„"å¤§è„‘"ï¼Œè´Ÿè´£å†³ç­–å’Œç®¡ç†
2. **å·¥ä½œèŠ‚ç‚¹ï¼ˆWorker Nodeï¼‰**ï¼šé›†ç¾¤çš„"æ‰‹è„š"ï¼Œè´Ÿè´£å®é™…è¿è¡Œå®¹å™¨

```mermaid
flowchart TD
    subgraph CP[æ§åˆ¶å¹³é¢ Control Plane]
        API[API Server<br/>API æœåŠ¡å™¨]
        ETCD[etcd<br/>æ•°æ®å­˜å‚¨]
        SCHED[Scheduler<br/>è°ƒåº¦å™¨]
        CM[Controller Manager<br/>æ§åˆ¶å™¨ç®¡ç†å™¨]
    end

    subgraph WN1[å·¥ä½œèŠ‚ç‚¹ 1]
        KL1[Kubelet<br/>èŠ‚ç‚¹ä»£ç†]
        KP1[Kube-proxy<br/>ç½‘ç»œä»£ç†]
        POD1[Pod]
        POD2[Pod]
    end

    subgraph WN2[å·¥ä½œèŠ‚ç‚¹ 2]
        KL2[Kubelet<br/>èŠ‚ç‚¹ä»£ç†]
        KP2[Kube-proxy<br/>ç½‘ç»œä»£ç†]
        POD3[Pod]
        POD4[Pod]
    end

    API --> ETCD
    API --> SCHED
    API --> CM
    API --> KL1
    API --> KL2
    KL1 --> POD1
    KL1 --> POD2
    KL2 --> POD3
    KL2 --> POD4
```

## æ§åˆ¶å¹³é¢ç»„ä»¶

æ§åˆ¶å¹³é¢è´Ÿè´£é›†ç¾¤çš„å…¨å±€å†³ç­–å’Œäº‹ä»¶å“åº”ã€‚

### 1. API Serverï¼ˆAPI æœåŠ¡å™¨ï¼‰

> ğŸ’¡ **ç±»æ¯”**ï¼šé¤å…çš„å‰å°æ¥å¾…ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½è¦ç»è¿‡å®ƒ

**API Server**ï¼ˆAPI æœåŠ¡å™¨ï¼ŒK8s çš„ RESTful API å…¥å£ï¼‰æ˜¯æ§åˆ¶å¹³é¢çš„å‰ç«¯ï¼Œè´Ÿè´£ï¼š

- æ¥æ”¶æ‰€æœ‰çš„ API è¯·æ±‚
- éªŒè¯è¯·æ±‚çš„åˆæ³•æ€§
- å¤„ç†è¯·æ±‚å¹¶æ›´æ–° etcd

```bash
# æ‰€æœ‰ kubectl å‘½ä»¤éƒ½æ˜¯é€šè¿‡ API Server æ‰§è¡Œçš„
kubectl get pods  # å®é™…ä¸Šæ˜¯è°ƒç”¨ API Server çš„ /api/v1/pods
```

### 2. etcdï¼ˆæ•°æ®å­˜å‚¨ï¼‰

> ğŸ’¡ **ç±»æ¯”**ï¼šé¤å…çš„è´¦æœ¬ï¼Œè®°å½•æ‰€æœ‰è®¢å•å’Œå‘˜å·¥ä¿¡æ¯

**etcd**ï¼ˆåˆ†å¸ƒå¼é”®å€¼å­˜å‚¨ï¼ŒK8s çš„"æ•°æ®åº“"ï¼‰è´Ÿè´£ï¼š

- å­˜å‚¨é›†ç¾¤çš„æ‰€æœ‰é…ç½®æ•°æ®
- å­˜å‚¨é›†ç¾¤çš„å½“å‰çŠ¶æ€
- æä¾›å¯é çš„åˆ†å¸ƒå¼å­˜å‚¨

### 3. Schedulerï¼ˆè°ƒåº¦å™¨ï¼‰

> ğŸ’¡ **ç±»æ¯”**ï¼šé¤å…çš„æ’ç­ç»ç†ï¼Œå†³å®šè°å¹²ä»€ä¹ˆæ´»

**Scheduler**ï¼ˆè°ƒåº¦å™¨ï¼Œå†³å®š Pod è¿è¡Œåœ¨å“ªä¸ªèŠ‚ç‚¹ï¼‰è´Ÿè´£ï¼š

- ç›‘å¬æ–°åˆ›å»ºä½†æœªåˆ†é…èŠ‚ç‚¹çš„ Pod
- æ ¹æ®èµ„æºéœ€æ±‚ã€ç­–ç•¥é™åˆ¶é€‰æ‹©æœ€ä¼˜èŠ‚ç‚¹
- å°†è°ƒåº¦å†³ç­–å‘ŠçŸ¥ API Server

### 4. Controller Managerï¼ˆæ§åˆ¶å™¨ç®¡ç†å™¨ï¼‰

> ğŸ’¡ **ç±»æ¯”**ï¼šé¤å…çš„å„éƒ¨é—¨ä¸»ç®¡

**Controller Manager**ï¼ˆæ§åˆ¶å™¨ç®¡ç†å™¨ï¼Œè¿è¡Œå„ç§æ§åˆ¶å™¨ï¼‰åŒ…å«å¤šä¸ªæ§åˆ¶å™¨ï¼š

| æ§åˆ¶å™¨ | èŒè´£ |
|--------|------|
| Node Controller | ç›‘æ§èŠ‚ç‚¹çŠ¶æ€ï¼ŒèŠ‚ç‚¹æ•…éšœæ—¶å“åº” |
| Replication Controller | ç¡®ä¿ Pod å‰¯æœ¬æ•°ç¬¦åˆé¢„æœŸ |
| Endpoints Controller | ç»´æŠ¤ Service å’Œ Pod çš„å…³è” |
| Service Account Controller | ç®¡ç†å‘½åç©ºé—´çš„é»˜è®¤è´¦å· |

## å·¥ä½œèŠ‚ç‚¹ç»„ä»¶

å·¥ä½œèŠ‚ç‚¹è¿è¡Œå®é™…çš„åº”ç”¨è´Ÿè½½ã€‚

### 1. Kubeletï¼ˆèŠ‚ç‚¹ä»£ç†ï¼‰

> ğŸ’¡ **ç±»æ¯”**ï¼šæ¯ä¸ªå¨å¸ˆèº«è¾¹çš„åŠ©æ‰‹ï¼Œç¡®ä¿å¨å¸ˆæŒ‰è¦æ±‚å·¥ä½œ

**Kubelet**ï¼ˆèŠ‚ç‚¹ä»£ç†ï¼Œç¡®ä¿å®¹å™¨åœ¨ Pod ä¸­è¿è¡Œï¼‰è´Ÿè´£ï¼š

- æ¥æ”¶ PodSpec
- ç¡®ä¿å®¹å™¨æŒ‰è§„èŒƒè¿è¡Œ
- æ±‡æŠ¥èŠ‚ç‚¹å’Œ Pod çŠ¶æ€

### 2. Kube-proxyï¼ˆç½‘ç»œä»£ç†ï¼‰

> ğŸ’¡ **ç±»æ¯”**ï¼šé¤å…çš„ä¼ èœå‘˜ï¼ŒæŠŠèœé€åˆ°æ­£ç¡®çš„æ¡Œå­

**Kube-proxy**ï¼ˆç½‘ç»œä»£ç†ï¼Œç»´æŠ¤èŠ‚ç‚¹ä¸Šçš„ç½‘ç»œè§„åˆ™ï¼‰è´Ÿè´£ï¼š

- ç»´æŠ¤ç½‘ç»œè§„åˆ™
- å®ç° Service çš„è´Ÿè½½å‡è¡¡
- è½¬å‘ç½‘ç»œæµé‡

### 3. Container Runtimeï¼ˆå®¹å™¨è¿è¡Œæ—¶ï¼‰

> ğŸ’¡ **ç±»æ¯”**ï¼šå¨æˆ¿çš„ç¶å°ï¼Œå®é™…åšèœçš„åœ°æ–¹

**Container Runtime**ï¼ˆå®¹å™¨è¿è¡Œæ—¶ï¼Œå¦‚ containerdã€Dockerï¼‰è´Ÿè´£ï¼š

- æ‹‰å–å®¹å™¨é•œåƒ
- åˆ›å»ºå’Œè¿è¡Œå®¹å™¨
- ç®¡ç†å®¹å™¨ç”Ÿå‘½å‘¨æœŸ

## ç»„ä»¶åä½œæµç¨‹

å½“ä½ æ‰§è¡Œ `kubectl run nginx --image=nginx` æ—¶ï¼š

```mermaid
flowchart TD
    A[1. kubectl å‘é€è¯·æ±‚] --> B[2. API Server æ¥æ”¶è¯·æ±‚]
    B --> C[3. å†™å…¥ etcd]
    C --> D[4. Scheduler å‘ç°æœªè°ƒåº¦ Pod]
    D --> E[5. Scheduler é€‰æ‹©èŠ‚ç‚¹]
    E --> F[6. Kubelet å‘ç°æ–°ä»»åŠ¡]
    F --> G[7. Container Runtime æ‹‰å–é•œåƒ]
    G --> H[8. å¯åŠ¨å®¹å™¨]
    H --> I[9. Kubelet æ±‡æŠ¥çŠ¶æ€]
```

## æ ¸å¿ƒæ¦‚å¿µæ˜ å°„

| æ¦‚å¿µ | ä½œç”¨ | ç±»æ¯” |
|------|------|------|
| Cluster | æ•´ä¸ª K8s ç³»ç»Ÿ | æ•´ä¸ªé¤å… |
| Control Plane | ç®¡ç†å†³ç­– | é¤å…ç®¡ç†å±‚ |
| Node | è¿è¡Œå®¹å™¨çš„æœºå™¨ | å¨æˆ¿å·¥ä½œå° |
| Pod | æœ€å°éƒ¨ç½²å•å…ƒ | ä¸€ä¸ªèœå“è®¢å• |

## å°ç»“

- K8s é›†ç¾¤ç”±**æ§åˆ¶å¹³é¢**å’Œ**å·¥ä½œèŠ‚ç‚¹**ç»„æˆ
- **æ§åˆ¶å¹³é¢**è´Ÿè´£å…¨å±€å†³ç­–ï¼šAPI Serverã€etcdã€Schedulerã€Controller Manager
- **å·¥ä½œèŠ‚ç‚¹**è´Ÿè´£è¿è¡Œè´Ÿè½½ï¼šKubeletã€Kube-proxyã€Container Runtime
- æ‰€æœ‰æ“ä½œéƒ½é€šè¿‡ **API Server** è¿›è¡Œï¼Œæ•°æ®å­˜å‚¨åœ¨ **etcd** ä¸­

## ä¸‹ä¸€æ­¥

äº†è§£äº†æ•´ä½“æ¶æ„åï¼Œè®©æˆ‘ä»¬æ·±å…¥å­¦ä¹  K8s ä¸­æœ€é‡è¦çš„æ¦‚å¿µâ€”â€”Podã€‚

[ä¸‹ä¸€èŠ‚ï¼šPod è¯¦è§£](/ops/kubernetes/concepts/pod)
